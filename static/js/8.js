(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{350:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(132),o=i(577),s=i(578),a=i(380),c=i(87),u=i(44),l=i(74),d=function(e){function SecteursRoutes(){var t=e.call(this)||this;return t.addPageRoute("/",function(){return new n.PageRouteInfos(s.SecteursPage,null,l.Injector.getRegistered(c.AdministrationSecteurService))},a.Roles.ADMIN),t.addDataRoute("/",function(){return new n.DataRouteInfos(o.ListerSecteurs,null,l.Injector.getRegistered(u.AdministrationSecteurServiceData))}),t.addDataRoute("/(\\d+)",function(e){return new n.DataRouteInfos(o.ModifierSecteur,{id:e},l.Injector.getRegistered(u.AdministrationSecteurServiceData))},a.Roles.ADMIN,"put"),t.addDataRoute("/(\\d+)",function(e){return new n.DataRouteInfos(o.SupprimerSecteur,{id:e},l.Injector.getRegistered(u.AdministrationSecteurServiceData))},a.Roles.ADMIN,"delete"),t.addDataRoute("/",function(e){return new n.DataRouteInfos(o.CreerSecteur,null,l.Injector.getRegistered(u.AdministrationSecteurServiceData))},a.Roles.ADMIN,"post"),t}return r.__extends(SecteursRoutes,e),SecteursRoutes}(n.AbstractRoutes);t.default=d},385:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(2),o=i(4),s=i(1),a=i(10),c=s.Logger.getLogger("hornet-js-react-components.widget.form.row"),u=function(e){function Row(t,i){return e.call(this,t,i)||this}return r.__extends(Row,e),Row.prototype.setClassName=function(e,t){return this.setState({className:e},t),this},Row.prototype.getPureChildFraction=function(){var e=0;return n.Children.forEach(this.state.children,function(t){var i=1;if(t&&t.props){if(t.props.groupClass){var r=t.props.groupClass.split("-");!(r.length&&r.length-1)||isNaN(r[r.length-1])||(i=r[r.length-1])}e+=Number(i)}}),e},Row.prototype.render=function(){c.debug("Row render");var e={};this.state.className&&(e[this.state.className]=!0);var t=this.props.fraction||this.getPureChildFraction();this.props.fraction?e.fraction=!0:e["has-gutter"]=!0,1!==t&&(e["grid-"+t]=!0);var i=a(e);return n.createElement("div",{className:i},n.Children.map(this.state.children,function(e,t){if(e&&e.props&&e.props.name){var i={groupClass:e.props.groupClass||""};return n.cloneElement(e,i)}return e}))},Row}(o.HornetComponent);t.Row=u},460:function(e){e.exports={$schema:"http://json-schema.org/schema#",title:"Liste des secteurs",description:"Validation des données de formulaire d'un secteur",type:"object",properties:{nom:{description:"Nom du secteur",type:"string",maxLength:50,required:!0}}}},577:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1),o=i(132),s=n.Logger.getLogger("applitutoriel.actions.adm.adm-lst-actions"),a=function(e){function ListerSecteurs(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(ListerSecteurs,e),ListerSecteurs.prototype.execute=function(){return s.trace("ACTION ListerSecteurs - Appel API : SecteurApi.lister - Dispatch SECTEUR_RECEIVE_LIST"),this.getService().lister()},ListerSecteurs}(o.RouteActionService);t.ListerSecteurs=a;var c=function(e){function SupprimerSecteur(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(SupprimerSecteur,e),SupprimerSecteur.prototype.execute=function(){return s.trace("ACTION SupprimerSecteur - Appel API : SecteurApi.supprimer - Dispatch SECTEUR_DELETED"),this.getService().supprimer(this.attributes.id)},SupprimerSecteur}(o.RouteActionService);t.SupprimerSecteur=c;var u=function(e){function ModifierSecteur(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(ModifierSecteur,e),ModifierSecteur.prototype.execute=function(){return s.trace("ACTION ModifierSecteur - Appel API : SecteurApi.modifier - Dispatch SECTEUR_UPDATED"),this.getService().modifier(this.attributes.id,this.req.body)},ModifierSecteur}(o.RouteActionService);t.ModifierSecteur=u;var l=function(e){function CreerSecteur(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(CreerSecteur,e),CreerSecteur.prototype.execute=function(){return s.trace("ACTION CreerSecteur - Appel API : SecteurApi.creer - Dispatch SECTEUR_CREATED"),this.getService().creer(this.req.body)},CreerSecteur}(o.RouteActionService);t.CreerSecteur=l},578:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n=i(1),o=i(2),s=i(495),a=i(18),c=i(134),u=i(47),l=i(133),d=i(396),m=i(385),p=i(386),f=i(376),h=i(387),S=i(370),g=i(378),E=i(425),C=i(411),b=i(412),v=i(388),A=i(389),y=i(403),R=i(424),D=i(377),I=i(384),M=i(398),N=i(520),T=i(375),P=i(375),w=i(11),L=i(665),_=i(460),F=n.Logger.getLogger("applitutoriel.views.adm.adm-lst-page"),x=function(e){function SecteursPage(t,i){var r=e.call(this,t,i)||this;r.focusOnEdition=!1,r.focusAdd=!1,r.secondRender=!1,r.refHeaderTable.bind(r);var n=new M.DefaultSort([new T.SortData("dateCreat"),new T.SortData("auteurCreat",P.SortDirection.ASC)]);return r.dataSource=new D.DataSource([],{},[n]),r}return r.__extends(SecteursPage,e),SecteursPage.prototype.focusEdition=function(){if(this.focusOnEdition&&this.itemEdited){var e=document.querySelector('a.edition-button-action-before[aria-label~="'+this.itemEdited.nom+'"]');e&&e.focus&&(e.focus(),this.focusOnEdition=!1,this.itemEdited=null)}if(this.focusAdd)if(this.secondRender){var t=document.getElementsByClassName("secteurs-add-button");t&&t[0]&&(t[0].focus(),this.focusAdd=!1,this.secondRender=!1)}else this.secondRender=!0},SecteursPage.prototype.prepareClient=function(){this.refreshSecteurs(),this.dataSource.on("add",function(){var e=document.getElementById("addSecteur");e&&e.focus&&e.focus()})},SecteursPage.prototype.refreshSecteurs=function(){var e=this;this.getService().lister().then(function(t){e.dataSource.deleteAll(),e.dataSource.add(!1,t)})},SecteursPage.prototype.refHeaderTable=function(e){this.headerTable=e},SecteursPage.prototype.render=function(){var e=this;F.trace("VIEW SecteursPage render");var t=this.i18n("administration.secteurs"),i=this.i18n("administration.secteurs.form");return o.createElement("div",null,o.createElement("h2",null,this.i18n("administration.secteurs.titreSecteur")),o.createElement(u.Notification,{id:"notif2"}),o.createElement(h.Table,{id:"liste-secteurs"},o.createElement(v.Header,{title:this.i18n("administration.secteurs").table.tableTitle,ref:this.refHeaderTable},o.createElement(R.ToggleColumnsButton,{hiddenColumns:{desc:!0,nom:!1},onChange:this.onChangeToggleColumns,selectAllItem:!1}),o.createElement(C.MenuActions,null,o.createElement(b.ActionButton,{className:"secteurs-add-button",title:this.i18n("administration.secteurs.table.addTitle"),srcImg:o.createElement(w.SvgSprites,{icon:"add",height:"1.5em",width:"1.5em",color:"#FFF",tabIndex:-1}),id:"addSecteur",displayedWithoutResult:!0,action:this.ajouterSecteur,priority:!0}),o.createElement(b.ActionButton,{title:this.i18n("administration.secteurs.table.sortMultiTitle"),srcImg:o.createElement(w.SvgSprites,{icon:"sort",height:"1.5em",width:"1.5em",color:"#FFF",tabIndex:-1}),action:this.sortMulti,priority:!0}))),o.createElement(A.Content,{ref:function(t){e.table=t},dataSource:this.dataSource,onSubmit:this.submitLineForm,schema:_,idForm:"secteurPageForm",notifId:"notif2",onRerender:this.focusEdition},o.createElement(g.Columns,null,o.createElement(S.Column,{keyColumn:"nom",title:t.nom,editable:!0,sortable:!0}),o.createElement(S.Column,{keyColumn:"desc",title:t.description,sortable:!1}),o.createElement(E.DateColumn,{keyColumn:"dateCreat",title:t.dateCr,sortable:!0}),o.createElement(E.DateColumn,{keyColumn:"dateMajEnreg",title:t.dateMaj,sortable:!1}),o.createElement(S.Column,{keyColumn:"auteurCreat",title:t.auteur,sortable:!0}),o.createElement(y.ActionColumn,{keyColumn:"id",alt:t.modificationTitle,srcImg:o.createElement(w.SvgSprites,{icon:"edit",height:"2em",width:"2em",color:"#0579be",tabIndex:-1}),action:this.editItem.bind(this)}),o.createElement(y.ActionColumn,{keyColumn:"id",alt:t.suppressionAlt,srcImg:o.createElement(w.SvgSprites,{icon:"delete",height:"2em",width:"2em",color:"#0579be",tabIndex:-1}),action:this.supprimer.bind(this),messageAlert:this.i18n("administration.secteurs.confirmationSuppression"),titleAlert:this.i18n("administration.secteurs.suppressionTitle")}),o.createElement(N.EditionActionColumn,{keyColumn:"id",titleEdit:t.quickUpdateTitle,titleSave:"Enregistrer",titleCancel:"Annuler",messageAlert:this.i18n("administration.secteurs.confirmationAnnulationAction"),titleAlert:this.i18n("administration.secteurs.annulationTitle")})))),o.createElement(c.Modal,{ref:function(t){e.maModale=t},withoutOverflow:!0,underlayClickExits:!1,focusDialog:!1,onClickClose:this.closeModal},o.createElement("div",{className:"content-modal-body"},o.createElement(d.Form,{id:"modalForm",ref:function(t){e.monForm=t,e.monForm&&e.monForm.updateFields(e.item)},schema:L,formMessages:i,onSubmit:this.onSubmitEdition},o.createElement(p.InputField,{name:"id",type:"hidden"}),o.createElement(m.Row,null,o.createElement(p.InputField,{name:"nom",label:i.fields.nom.label,required:!0,size:40,maxLength:50})),o.createElement(m.Row,null,o.createElement(p.InputField,{name:"desc",label:i.fields.desc.label,required:!0,size:40,maxLength:200})),o.createElement(I.ButtonsArea,null,o.createElement(f.Button,{type:"submit",id:"enregistrer",name:"action:save",value:"Enregistrer",className:"hornet-button",label:this.i18n("form.valid"),title:this.i18n("administration.validTitle")}),o.createElement(f.Button,{type:"button",id:"cancel",name:"action:cancel",value:"Annuler",className:"hornet-button",label:this.i18n("form.cancel"),title:this.i18n("administration.cancelTitle"),onClick:this.closeModal}))))))},SecteursPage.prototype.onChangeToggleColumns=function(e){F.debug("MAJ toggle columns :",e)},SecteursPage.prototype.submitLineForm=function(e){var t=this;e.user=this.user.name,this.getService().modifier(e.id,e).then(function(){l.NotificationManager.notify(null,"secteurPageForm",null,l.Notifications.makeSingleNotification("SECTEUR_DELETED","info.message.IN-AD-LST-01")),t.refreshSecteurs(),t.focusOnEdition=!0,t.itemEdited=e})},SecteursPage.prototype.supprimer=function(e){var t=this;F.trace("Utilisateur est OK pour supprimer l item id:",e.id),l.NotificationManager.cleanAll(),this.getService().supprimer(e.id).then(function(e){e&&(l.NotificationManager.notify(null,null,null,l.Notifications.makeSingleNotification("SECTEUR_DELETED","info.message.IN-AD-LST-02")),t.refreshSecteurs(),t.focusAdd=!0)}).catch(function(e){l.NotificationManager.notify("notif2",null,null,null,e.errors)})},SecteursPage.prototype.editItem=function(e){this.maModale.setTitle(this.i18n("administration.modification")),this.maModale.setCloseLabel(this.i18n("administration.closeModification")),this.item=e,this.maModale.open()},SecteursPage.prototype.ajouterSecteur=function(){this.maModale.setTitle(this.i18n("administration.ajout")).setCloseLabel(this.i18n("administration.closeAjout")).open()},SecteursPage.prototype.sortMulti=function(){this.dataSource.sort({sortDatas:[new T.SortData("dateCreat",P.SortDirection.DESC),new T.SortData("auteurCreat")]})},SecteursPage.prototype.closeModal=function(){this.maModale.close(),this.item=null},SecteursPage.prototype.onSubmitEdition=function(e){var t=this;l.NotificationManager.cleanAll();var i=e;s(i.id)?(this.user&&(i.user=this.user.name),this.getService().creer(i).then(function(e){e.errors||(t.closeModal(),l.NotificationManager.notify(null,"secteurPageForm",null,l.Notifications.makeSingleNotification("notif2",t.i18n("info.message.IN-AD-LST-03"))),t.refreshSecteurs())})):this.getService().modifier(i.id,i).then(function(e){e.errors||(l.NotificationManager.notify("notif2","secteurPageForm",null,l.Notifications.makeSingleNotification("notif2",t.i18n("info.message.IN-AD-LST-03"))),t.closeModal(),t.refreshSecteurs())})},SecteursPage}(a.HornetPage);t.SecteursPage=x},665:function(e){e.exports={$schema:"http://json-schema.org/schema#",title:"Liste des secteurs",description:"Validation des données de formulaire d'un secteur",type:"object",properties:{nom:{description:"Nom du secteur",type:"string",maxLength:50,required:!0},desc:{description:"Description du secteur",type:"string",maxLength:200,required:!0}}}}}]);